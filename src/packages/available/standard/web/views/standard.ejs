<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Standard Package - RiikonBot</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <%- include('partials/navbar', { user: user }) %>
  
  <div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <div>
        <h1 class="mb-0">Standard Package</h1>
        <p class="text-muted">Core functionality for RiikonBot</p>
      </div>
      <span class="badge <%= package.enabled ? 'bg-success' : 'bg-secondary' %> fs-6">
        <%= package.enabled ? 'Enabled' : 'Disabled' %>
      </span>
    </div>
    
    <div class="row">
      <div class="col-md-6">
        <div class="card mb-4">
          <div class="card-header">
            <h5 class="mb-0">Basic Commands</h5>
          </div>
          <div class="card-body">
            <ul class="list-group list-group-flush">
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                  <h6 class="mb-0">/ping</h6>
                  <small class="text-muted">Check the bot's response time</small>
                </div>
                <span class="badge bg-primary rounded-pill">Slash</span>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                  <h6 class="mb-0"><%= package.config.prefix %>ping</h6>
                  <small class="text-muted">Check the bot's response time</small>
                </div>
                <span class="badge bg-secondary rounded-pill">Prefix</span>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                  <h6 class="mb-0">/help</h6>
                  <small class="text-muted">Show list of available commands</small>
                </div>
                <span class="badge bg-primary rounded-pill">Slash</span>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                  <h6 class="mb-0"><%= package.config.prefix %>help</h6>
                  <small class="text-muted">Show list of available commands</small>
                </div>
                <span class="badge bg-secondary rounded-pill">Prefix</span>
              </li>
            </ul>
          </div>
        </div>
      </div>
      
      <div class="col-md-6">
        <div class="card mb-4">
          <div class="card-header">
            <h5 class="mb-0">Configuration</h5>
          </div>
          <div class="card-body">
            <form id="configForm">
              <div class="mb-3">
                <label for="prefix" class="form-label">Command Prefix</label>
                <input type="text" class="form-control" id="prefix" value="<%= package.config.prefix %>" maxlength="5">
                <div class="form-text">The prefix used for text commands (e.g., <%= package.config.prefix %>help)</div>
              </div>
              
              <div class="mb-3">
                <label for="color" class="form-label">Theme Color</label>
                <input type="color" class="form-control form-control-color" id="color" value="<%= package.config.color %>" title="Choose theme color">
              </div>
              
              <div class="d-grid">
                <button type="submit" class="btn btn-primary">Save Changes</button>
              </div>
            </form>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <h5 class="mb-0">Statistics</h5>
          </div>
          <div class="card-body">
            <p><strong>Servers:</strong> <%= botClient.guilds.cache.size %></p>
            <p><strong>Users:</strong> <%= botClient.users.cache.size %></p>
            <p><strong>Uptime:</strong> <%= Math.floor(botClient.uptime / 3600000) %>h <%= Math.floor((botClient.uptime % 3600000) / 60000) %>m</p>
          </div>
        </div>
      </div>
    </div>
    
    <div class="mt-4">
      <a href="/dashboard" class="btn btn-secondary">Back to Dashboard</a>
      <a href="/packages/standard/commands" class="btn btn-primary">View All Commands</a>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const configForm = document.getElementById('configForm');
      
      configForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const prefix = document.getElementById('prefix').value;
        const color = document.getElementById('color').value;
        
        try {
          const response = await fetch('/api/packages/standard/config', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              config: {
                prefix,
                color,
                enabled: true,
                title: "RiikonBot"
              }
            })
          });
          
          if (response.ok) {
            alert('Configuration saved successfully!');
            window.location.reload();
          } else {
            const error = await response.json();
            alert(`Error: ${error.error}`);
          }
        } catch (error) {
          console.error('Error saving configuration:', error);
          alert('Failed to save configuration. See console for details.');
        }
      });
    });
  </script>
</body>
</html>
